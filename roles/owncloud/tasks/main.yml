- name: Create directory for owncloud
  ansible.builtin.file:
    path: "/home/{{ admin_user }}/owncloud/"
    state: directory

- name: Copy owncloud k8s files
  ansible.builtin.copy:
    src: "{{ item }}"
    dest: "/home/{{ admin_user }}/owncloud/"
  loop: ['01-namespace.yml', '02-deployment.yml', '03-service.yml']
  register: owncloud_k8s_files
  
- name: Deploy owncloud
  ansible.builtin.command:
    cmd: kubectl apply -f "/home/{{ admin_user }}/owncloud/"
  when: owncloud_k8s_files is changed

